I have tested this code with the circuits@home usb host shield. Found here: https://www.circuitsathome.com/products-page/arduino-shields/usb-host-shield-2-0-for-arduino

Don't forget to flash the firmware of the arduino's built in USB port to be a HID device. Information can be found by googling this and searching the documentation for the usb host shield.
